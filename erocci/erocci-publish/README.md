# occiware-ozwillo

To install erocci and to know how this project was developed, please check the ![Tutorial Occiware for ozwillo](./Tutorial_ozwillo.pdf).


### Prototype project directories

* org.ozwillo.data.model.dcproject
 - Contains an OCCI Extension that models resources of Ozwillo platform (occie)
* org.ozwillo.data.ozwillo.samples
 - Contains a sample representation of Ozwillo resources (Project, model, links) in occic format. This representation was developed using the CloudDesigner created by Obeo.
* org.eclipse.acceleo.module.occiware.ozwillo
 - Contains the Ozwillo Curl Generators using the occi configuration "occic", actually allowing for now only to do a POST (genOCCIPost.mtl), and that should later be replaced by the Studio's generic curl generator.
* org.ozwillo.data.designer.docker
 - Contains Ozwillo docker configurations : a drawing of the high-level production architecture, and a configuration of a possible future dockerization of the Ozwillo platform in production.

NB. This projects should be loaded in the Eclipse version built by Obeo (CloudDesigner).


### Docker configuration 

The directory that contains the configuration file is named "![docker-erocci-ozwillo](./docker-erocci-ozwillo)".

It contains the files required to configure the docker/erocci :
 - sys.config
 - occie in xml format (which must be setup in sys.config, and has been generated by the Studio)

*Also you can check the ![docker-erocci](https://github.com/erocci/docker-erocci) project to obtain the required files to launch a docker container having the erocci system interface .*

## 20161007 suppl - expose (Linked Data) connector as an OCCI HTTP API:
(using [erocci](https://github.com/erocci/erocci/), and test it using OCCInterface)

### Build and start erocci-dbus-java-linkeddata:
The [erocci-dbus-java-linkeddata project](https://github.com/occiware/occiware-ozwillo/blob/master/connector-analytics/erocci-dbus-java-linkeddata/pom.xml) is merely erocci-dbus-java with the Linked Data connector and its dependencies. The Linked Data connector is configured to manage an Ozwillo Datacore server that is deployed at http://localhost:8080 by default (where it should be available after the previous steps).

Beware, building it requires that the Linked Data connector has been built and installed in your local maven repository. So if you've not done it yet, first build the OCCIware Studio as explained previously.

``` bash
cd erocci-dbus-java-linkeddata
# install JNI deps:
mvn initialize
mvn clean install
# do: (JNI being OK)
mvn exec:java -Dexec.mainClass="org.ow2.erocci.backend.BackendDBusService"
```

### Clone and build [erocci](https://github.com/erocci/erocci/):
``` bash
git clone git@github.com:erocci/erocci.git
cd erocci
git checkout 9d1349049217482ecec0fec33f4ecff047dde07f
# else GET /-/ returns 404 with newer erocci deps
make FRONTEND=1

# Start erocci with DBus for OCCIware (on port 8081):
./start.sh -c ../occiware-ozwillo/connector-analytics/erocci-dbus-java-linkeddata/sys.config
```

Then erocci should be available at http://localhost:8081, and its embedded OCCInterface UI at http://localhost:8081/_frontend .

### Clone, build and start OCCInterface (generic OCCI playground):
If you want your own standalone OCCInterface, so that you can add custom examples for instance (or if erocci's embedded OCCInterface doesn't work), get it up and running this way.

First, if you don't have the right version of node and npm (6.2.0 works), an easy way to install both, whatever the version of node you already have, is to install [nvm](https://github.com/creationix/nvm):
``` bash
sudo apt-get update
sudo apt-get install build-essential libssl-dev
curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.32.0/install.sh | bash
nvm install v6.2.0
```

Then build and run:

``` bash
git clone git@github.com:occiware/OCCInterface.git
cd OCCInterface
npm install
npm run dev
```

Now use your web browser to go to [http://localhost:3000/](http://localhost:3000/) where it has been made available. There write http://localhost:8081 as the OCCI server URL in the top input field and click on the Use button.

### Test the Linked Data & Docker OCCI HTTP API using OCCInterface:
Click on the GET button to display the definition of all available OCCI extensions.

Click on the top dropdown (Kinds): it should display all of its available OCCI extensions, and below their kinds. Clicking on each of them should list their instanciated OCCI resources. For instance, click on:
- linkeddata > LDProject to list all data projects, then click on a project that has been configured using the Linked Data Studio ("energy_xx" projects) to see its configuration. Then click on Edit then Post to change its configuration, just as it would be done using the Linked Data Studio, and just the same, changes can be seen in the Ozwillo Datacore playground at http://localhost:8080/dc-ui/index.html (BEWARE http://localhost:8080 may be broken).
- docker > ? to list all ? ; NOT WORKING YET see occiware/ecore#173 Docker connector kills erocci because has boolean attributes
